# ğŸ§® å…«å­—æ’ç›˜å·¥å…· - åŠŸèƒ½è§„åˆ’æ–‡æ¡£

> **ç›®æ ‡**ï¼šä¸ºä¸äº†è§£å…«å­—çš„ç”¨æˆ·æä¾›è‡ªåŠ¨æ’ç›˜åŠŸèƒ½ï¼Œåªéœ€è¾“å…¥å‡ºç”Ÿå¹´æœˆæ—¥æ—¶é—´ï¼Œå³å¯è‡ªåŠ¨ç”Ÿæˆå››æŸ±å¹²æ”¯å’Œå¤§è¿ä¿¡æ¯ã€‚

---

## ä¸€ã€åŠŸèƒ½æ¦‚è¿°

### 1.1 å½“å‰é—®é¢˜

ç°æœ‰ç³»ç»Ÿè¦æ±‚ç”¨æˆ·æ‰‹åŠ¨è¾“å…¥ï¼š
- å››æŸ±å¹²æ”¯ï¼ˆå¹´æŸ±ã€æœˆæŸ±ã€æ—¥æŸ±ã€æ—¶æŸ±ï¼‰
- èµ·è¿å¹´é¾„
- ç¬¬ä¸€æ­¥å¤§è¿

**é—®é¢˜**ï¼šå¤§å¤šæ•°ç”¨æˆ·ä¸å…·å¤‡æ’ç›˜çŸ¥è¯†ï¼Œæ— æ³•è‡ªè¡Œè·å–è¿™äº›ä¿¡æ¯ã€‚

### 1.2 è§£å†³æ–¹æ¡ˆ

æ·»åŠ "è‡ªåŠ¨æ’ç›˜"åŠŸèƒ½ï¼š
- ç”¨æˆ·åªéœ€è¾“å…¥ï¼š**å‡ºç”Ÿå¹´ã€æœˆã€æ—¥ã€æ—¶ã€åˆ†ã€æ€§åˆ«**
- ç³»ç»Ÿè‡ªåŠ¨è®¡ç®—å¹¶å¡«å……ï¼šå››æŸ±å¹²æ”¯ã€èµ·è¿å¹´é¾„ã€ç¬¬ä¸€æ­¥å¤§è¿ã€å¤§è¿æ–¹å‘

### 1.3 åŠŸèƒ½æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·è¾“å…¥                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  å¹´ä»½   â”‚ â”‚  æœˆä»½   â”‚ â”‚  æ—¥æœŸ   â”‚ â”‚  æ—¶è¾°   â”‚ â”‚  æ€§åˆ«   â”‚   â”‚
â”‚  â”‚  1990   â”‚ â”‚   5     â”‚ â”‚   15    â”‚ â”‚  10:30  â”‚ â”‚   ç”·    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                     [ ç‚¹å‡»"è‡ªåŠ¨æ’ç›˜" ]
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      è‡ªåŠ¨ç”Ÿæˆç»“æœ                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚  å¹´æŸ±   â”‚ â”‚  æœˆæŸ±   â”‚ â”‚  æ—¥æŸ±   â”‚ â”‚  æ—¶æŸ±   â”‚               â”‚
â”‚  â”‚  åºšåˆ   â”‚ â”‚  è¾›å·³   â”‚ â”‚  ç”²ç”³   â”‚ â”‚  å·±å·³   â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                  â”‚
â”‚  èµ·è¿å¹´é¾„: 8å²    ç¬¬ä¸€æ­¥å¤§è¿: å£¬åˆ    å¤§è¿æ–¹å‘: é¡ºè¡Œ             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äºŒã€æŠ€æœ¯æ–¹æ¡ˆ

### 2.1 æ¨èæ–¹æ¡ˆï¼šä½¿ç”¨ lunar-javascript åº“

**lunar-javascript** æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œå–„çš„å†œå†/å…«å­—è®¡ç®—åº“ï¼Œæ”¯æŒï¼š
- é˜³å†è½¬å†œå†
- å…«å­—å››æŸ±è®¡ç®—
- å¤§è¿è®¡ç®—
- èŠ‚æ°”åˆ¤æ–­
- ç¥ç…è®¡ç®—

```bash
npm install lunar-javascript
```

**ä¼˜ç‚¹**ï¼š
- âœ… æˆç†Ÿç¨³å®šï¼ŒGitHub 4k+ stars
- âœ… çº¯ JavaScriptï¼Œæ— éœ€åç«¯
- âœ… åŠŸèƒ½å…¨é¢ï¼ŒåŒ…å«å®Œæ•´çš„å…«å­—è®¡ç®—
- âœ… æŒç»­ç»´æŠ¤æ›´æ–°

### 2.2 å¤‡é€‰æ–¹æ¡ˆ

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|------|
| è‡ªè¡Œå®ç°ç®—æ³• | æ— ä¾èµ–ã€å¯å®šåˆ¶ | å·¥ä½œé‡å¤§ã€æ˜“å‡ºé”™ |
| è°ƒç”¨ç¬¬ä¸‰æ–¹ API | æ— éœ€æœ¬åœ°è®¡ç®— | éœ€è¦ç½‘ç»œã€å¯èƒ½æ”¶è´¹ |
| ä½¿ç”¨å…¶ä»–åº“ | - | åŠŸèƒ½å¯èƒ½ä¸å…¨ |

### 2.3 æ ¸å¿ƒä¾èµ–

```json
{
  "dependencies": {
    "lunar-javascript": "^1.6.12"
  }
}
```

---

## ä¸‰ã€æ•°æ®ç»“æ„è®¾è®¡

### 3.1 ç”¨æˆ·è¾“å…¥

```typescript
interface BirthTimeInput {
  year: number;         // å‡ºç”Ÿå¹´ä»½ (é˜³å†)ï¼Œå¦‚ 1990
  month: number;        // å‡ºç”Ÿæœˆä»½ (é˜³å†)ï¼Œ1-12
  day: number;          // å‡ºç”Ÿæ—¥æœŸ (é˜³å†)ï¼Œ1-31
  hour: number;         // å‡ºç”Ÿæ—¶è¾°ï¼Œ0-23
  minute: number;       // å‡ºç”Ÿåˆ†é’Ÿï¼Œ0-59
  gender: 'male' | 'female';  // æ€§åˆ«
  isLunar?: boolean;    // æ˜¯å¦å†œå†è¾“å…¥ï¼ˆå¯é€‰ï¼Œé»˜è®¤é˜³å†ï¼‰
}
```

### 3.2 æ’ç›˜ç»“æœ

```typescript
interface PaipanResult {
  // å››æŸ±ä¿¡æ¯
  yearPillar: string;   // å¹´æŸ±ï¼Œå¦‚ "åºšåˆ"
  monthPillar: string;  // æœˆæŸ±ï¼Œå¦‚ "è¾›å·³"
  dayPillar: string;    // æ—¥æŸ±ï¼Œå¦‚ "ç”²ç”³"
  hourPillar: string;   // æ—¶æŸ±ï¼Œå¦‚ "å·±å·³"
  
  // å¤§è¿ä¿¡æ¯
  startAge: number;     // èµ·è¿å¹´é¾„ï¼ˆè™šå²ï¼‰
  firstDaYun: string;   // ç¬¬ä¸€æ­¥å¤§è¿å¹²æ”¯
  daYunDirection: 'forward' | 'backward';  // å¤§è¿æ–¹å‘
  
  // é™„åŠ ä¿¡æ¯
  lunarDate: string;    // å†œå†æ—¥æœŸ
  solarTerm: string;    // èŠ‚æ°”
  zodiac: string;       // ç”Ÿè‚–
  dayMaster: string;    // æ—¥ä¸»ï¼ˆæ—¥å¹²ï¼‰
  
  // å¤§è¿åˆ—è¡¨ï¼ˆ10æ­¥ï¼‰
  daYunList: Array<{
    ganZhi: string;     // å¤§è¿å¹²æ”¯
    startAge: number;   // å¼€å§‹å¹´é¾„
    endAge: number;     // ç»“æŸå¹´é¾„
  }>;
}
```

---

## å››ã€æ ¸å¿ƒå®ç°

### 4.1 åˆ›å»ºæ’ç›˜æœåŠ¡

**æ–‡ä»¶**: `services/paipanService.ts`

```typescript
import { Solar, Lunar } from 'lunar-javascript';

export interface BirthTimeInput {
  year: number;
  month: number;
  day: number;
  hour: number;
  minute: number;
  gender: 'male' | 'female';
}

export interface PaipanResult {
  yearPillar: string;
  monthPillar: string;
  dayPillar: string;
  hourPillar: string;
  startAge: number;
  firstDaYun: string;
  daYunDirection: 'forward' | 'backward';
  lunarDate: string;
  solarTerm: string;
  zodiac: string;
  dayMaster: string;
  daYunList: Array<{
    ganZhi: string;
    startAge: number;
    endAge: number;
  }>;
}

/**
 * æ ¹æ®å‡ºç”Ÿæ—¶é—´è‡ªåŠ¨æ’ç›˜
 */
export function calculateBazi(input: BirthTimeInput): PaipanResult {
  // 1. åˆ›å»ºé˜³å†æ—¥æœŸå¯¹è±¡
  const solar = Solar.fromYmdHms(
    input.year,
    input.month,
    input.day,
    input.hour,
    input.minute,
    0
  );
  
  // 2. è·å–å†œå†ä¿¡æ¯
  const lunar = solar.getLunar();
  
  // 3. è·å–å…«å­—
  const bazi = lunar.getEightChar();
  
  // 4. è·å–å››æŸ±
  const yearPillar = bazi.getYear();
  const monthPillar = bazi.getMonth();
  const dayPillar = bazi.getDay();
  const hourPillar = bazi.getTime();
  
  // 5. è·å–å¤§è¿ï¼ˆ1=ç”·, 0=å¥³ï¼‰
  const genderValue = input.gender === 'male' ? 1 : 0;
  const yun = bazi.getYun(genderValue);
  
  // 6. è·å–èµ·è¿å¹´é¾„
  const startAge = yun.getStartYear();
  
  // 7. è·å–å¤§è¿åˆ—è¡¨
  const daYunArr = yun.getDaYun();
  const daYunList = daYunArr.slice(1, 11).map((dy: any, index: number) => ({
    ganZhi: dy.getGanZhi(),
    startAge: startAge + index * 10,
    endAge: startAge + (index + 1) * 10 - 1,
  }));
  
  // 8. åˆ¤æ–­å¤§è¿æ–¹å‘ï¼ˆé¡ºè¡Œ/é€†è¡Œï¼‰
  const yearGan = yearPillar.charAt(0);
  const yangGans = ['ç”²', 'ä¸™', 'æˆŠ', 'åºš', 'å£¬'];
  const isYangYear = yangGans.includes(yearGan);
  const isForward = input.gender === 'male' ? isYangYear : !isYangYear;
  
  return {
    yearPillar,
    monthPillar,
    dayPillar,
    hourPillar,
    startAge,
    firstDaYun: daYunList[0]?.ganZhi || '',
    daYunDirection: isForward ? 'forward' : 'backward',
    lunarDate: lunar.toString(),
    solarTerm: lunar.getJieQi() || 'æ— ',
    zodiac: lunar.getYearShengXiao(),
    dayMaster: dayPillar.charAt(0),
    daYunList,
  };
}

/**
 * è·å–åäºŒæ—¶è¾°åˆ—è¡¨ï¼ˆç”¨äºä¸‹æ‹‰é€‰æ‹©ï¼‰
 */
export function getShiChenList(): Array<{ value: number; label: string; range: string }> {
  return [
    { value: 0, label: 'å­æ—¶', range: '23:00-01:00' },
    { value: 2, label: 'ä¸‘æ—¶', range: '01:00-03:00' },
    { value: 4, label: 'å¯…æ—¶', range: '03:00-05:00' },
    { value: 6, label: 'å¯æ—¶', range: '05:00-07:00' },
    { value: 8, label: 'è¾°æ—¶', range: '07:00-09:00' },
    { value: 10, label: 'å·³æ—¶', range: '09:00-11:00' },
    { value: 12, label: 'åˆæ—¶', range: '11:00-13:00' },
    { value: 14, label: 'æœªæ—¶', range: '13:00-15:00' },
    { value: 16, label: 'ç”³æ—¶', range: '15:00-17:00' },
    { value: 18, label: 'é…‰æ—¶', range: '17:00-19:00' },
    { value: 20, label: 'æˆŒæ—¶', range: '19:00-21:00' },
    { value: 22, label: 'äº¥æ—¶', range: '21:00-23:00' },
  ];
}
```

### 4.2 åˆ›å»ºæ’ç›˜è¡¨å•ç»„ä»¶

**æ–‡ä»¶**: `components/AutoPaipanForm.tsx`

```typescript
import React, { useState } from 'react';
import { calculateBazi, PaipanResult, getShiChenList } from '../services/paipanService';
import { Calendar, Clock, User, Sparkles, AlertCircle } from 'lucide-react';

interface AutoPaipanFormProps {
  onResult: (result: PaipanResult) => void;
}

const AutoPaipanForm: React.FC<AutoPaipanFormProps> = ({ onResult }) => {
  const [formData, setFormData] = useState({
    year: new Date().getFullYear() - 30,
    month: 1,
    day: 1,
    hour: 12,
    minute: 0,
    gender: 'male' as 'male' | 'female',
    useShiChen: true,  // æ˜¯å¦ä½¿ç”¨æ—¶è¾°é€‰æ‹©
  });
  
  const [result, setResult] = useState<PaipanResult | null>(null);
  const [error, setError] = useState<string | null>(null);
  
  const shiChenList = getShiChenList();
  
  const handleCalculate = () => {
    try {
      setError(null);
      const paipanResult = calculateBazi(formData);
      setResult(paipanResult);
      onResult(paipanResult);
    } catch (err: any) {
      setError(`æ’ç›˜å¤±è´¥ï¼š${err.message}`);
    }
  };
  
  // ç”Ÿæˆå¹´ä»½é€‰é¡¹ï¼ˆ1900-2100ï¼‰
  const yearOptions = Array.from({ length: 201 }, (_, i) => 1900 + i);
  
  // ç”Ÿæˆæœˆä»½é€‰é¡¹
  const monthOptions = Array.from({ length: 12 }, (_, i) => i + 1);
  
  // ç”Ÿæˆæ—¥æœŸé€‰é¡¹ï¼ˆæ ¹æ®å¹´æœˆåŠ¨æ€è®¡ç®—ï¼‰
  const getDaysInMonth = (year: number, month: number) => {
    return new Date(year, month, 0).getDate();
  };
  const dayOptions = Array.from(
    { length: getDaysInMonth(formData.year, formData.month) },
    (_, i) => i + 1
  );
  
  return (
    <div className="bg-gradient-to-br from-purple-50 to-indigo-50 p-6 rounded-xl border border-purple-200">
      <div className="flex items-center gap-2 mb-4">
        <Calendar className="w-5 h-5 text-purple-600" />
        <h3 className="font-bold text-purple-800">è‡ªåŠ¨æ’ç›˜</h3>
        <span className="text-xs text-purple-500">è¾“å…¥å‡ºç”Ÿæ—¶é—´ï¼Œè‡ªåŠ¨ç”Ÿæˆå…«å­—</span>
      </div>
      
      {/* å‡ºç”Ÿæ—¥æœŸ */}
      <div className="grid grid-cols-3 gap-3 mb-4">
        <div>
          <label className="block text-xs font-bold text-gray-600 mb-1">å¹´</label>
          <select
            value={formData.year}
            onChange={(e) => setFormData({ ...formData, year: parseInt(e.target.value) })}
            className="w-full px-3 py-2 border border-purple-200 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none"
          >
            {yearOptions.map(y => (
              <option key={y} value={y}>{y}å¹´</option>
            ))}
          </select>
        </div>
        <div>
          <label className="block text-xs font-bold text-gray-600 mb-1">æœˆ</label>
          <select
            value={formData.month}
            onChange={(e) => setFormData({ ...formData, month: parseInt(e.target.value) })}
            className="w-full px-3 py-2 border border-purple-200 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none"
          >
            {monthOptions.map(m => (
              <option key={m} value={m}>{m}æœˆ</option>
            ))}
          </select>
        </div>
        <div>
          <label className="block text-xs font-bold text-gray-600 mb-1">æ—¥</label>
          <select
            value={formData.day}
            onChange={(e) => setFormData({ ...formData, day: parseInt(e.target.value) })}
            className="w-full px-3 py-2 border border-purple-200 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none"
          >
            {dayOptions.map(d => (
              <option key={d} value={d}>{d}æ—¥</option>
            ))}
          </select>
        </div>
      </div>
      
      {/* å‡ºç”Ÿæ—¶è¾° */}
      <div className="grid grid-cols-2 gap-3 mb-4">
        <div>
          <label className="block text-xs font-bold text-gray-600 mb-1">
            <Clock className="w-3 h-3 inline mr-1" />
            æ—¶è¾°
          </label>
          <select
            value={formData.hour}
            onChange={(e) => setFormData({ ...formData, hour: parseInt(e.target.value) })}
            className="w-full px-3 py-2 border border-purple-200 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none"
          >
            {shiChenList.map(sc => (
              <option key={sc.value} value={sc.value}>
                {sc.label} ({sc.range})
              </option>
            ))}
            <option value={-1}>ä¸çŸ¥é“æ—¶è¾°</option>
          </select>
        </div>
        <div>
          <label className="block text-xs font-bold text-gray-600 mb-1">
            <User className="w-3 h-3 inline mr-1" />
            æ€§åˆ«
          </label>
          <select
            value={formData.gender}
            onChange={(e) => setFormData({ ...formData, gender: e.target.value as 'male' | 'female' })}
            className="w-full px-3 py-2 border border-purple-200 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none"
          >
            <option value="male">ç”· (ä¹¾é€ )</option>
            <option value="female">å¥³ (å¤é€ )</option>
          </select>
        </div>
      </div>
      
      {/* æ’ç›˜æŒ‰é’® */}
      <button
        onClick={handleCalculate}
        className="w-full bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white font-bold py-3 rounded-xl shadow-lg transition-all flex items-center justify-center gap-2"
      >
        <Sparkles className="w-5 h-5" />
        è‡ªåŠ¨æ’ç›˜
      </button>
      
      {/* é”™è¯¯æç¤º */}
      {error && (
        <div className="mt-4 flex items-center gap-2 text-red-600 bg-red-50 px-4 py-3 rounded-lg">
          <AlertCircle className="w-5 h-5" />
          <span className="text-sm">{error}</span>
        </div>
      )}
      
      {/* æ’ç›˜ç»“æœé¢„è§ˆ */}
      {result && (
        <div className="mt-4 p-4 bg-white rounded-xl border border-purple-100">
          <h4 className="font-bold text-gray-800 mb-3">æ’ç›˜ç»“æœ</h4>
          
          {/* å››æŸ± */}
          <div className="grid grid-cols-4 gap-2 mb-4">
            {[
              { label: 'å¹´æŸ±', value: result.yearPillar },
              { label: 'æœˆæŸ±', value: result.monthPillar },
              { label: 'æ—¥æŸ±', value: result.dayPillar },
              { label: 'æ—¶æŸ±', value: result.hourPillar },
            ].map((item, i) => (
              <div key={i} className="text-center p-2 bg-gray-50 rounded-lg">
                <div className="text-xs text-gray-500">{item.label}</div>
                <div className="text-xl font-serif-sc font-bold text-gray-800">{item.value}</div>
              </div>
            ))}
          </div>
          
          {/* é™„åŠ ä¿¡æ¯ */}
          <div className="grid grid-cols-2 gap-2 text-sm">
            <div className="flex justify-between">
              <span className="text-gray-500">å†œå†:</span>
              <span className="font-medium">{result.lunarDate}</span>
            </div>
            <div className="flex justify-between">
              <span className="text-gray-500">ç”Ÿè‚–:</span>
              <span className="font-medium">{result.zodiac}</span>
            </div>
            <div className="flex justify-between">
              <span className="text-gray-500">èµ·è¿:</span>
              <span className="font-medium">{result.startAge}å²</span>
            </div>
            <div className="flex justify-between">
              <span className="text-gray-500">é¦–è¿:</span>
              <span className="font-medium">{result.firstDaYun}</span>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

export default AutoPaipanForm;
```

---

## äº”ã€UI é›†æˆæ–¹æ¡ˆ

### 5.1 ä¿®æ”¹ ImportDataMode.tsx

åœ¨ç°æœ‰çš„å…«å­—è¾“å…¥è¡¨å•ä¸­æ·»åŠ "è‡ªåŠ¨æ’ç›˜"é€‰é¡¹å¡ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚   â”‚  ğŸ”® è‡ªåŠ¨æ’ç›˜     â”‚  â”‚  âœï¸ æ‰‹åŠ¨è¾“å…¥     â”‚   â† åˆ‡æ¢é€‰é¡¹å¡    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   [è‡ªåŠ¨æ’ç›˜è¡¨å•]                                                 â”‚
â”‚   æˆ–                                                             â”‚
â”‚   [æ‰‹åŠ¨è¾“å…¥è¡¨å•ï¼ˆç°æœ‰ï¼‰]                                         â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 äº¤äº’æµç¨‹

```
ç”¨æˆ·é€‰æ‹©"è‡ªåŠ¨æ’ç›˜"
       â†“
è¾“å…¥å‡ºç”Ÿå¹´æœˆæ—¥æ—¶
       â†“
ç‚¹å‡»"è‡ªåŠ¨æ’ç›˜"æŒ‰é’®
       â†“
æ˜¾ç¤ºæ’ç›˜ç»“æœé¢„è§ˆ
       â†“
è‡ªåŠ¨å¡«å……åˆ°å…«å­—è¡¨å•
       â†“
ç»§ç»­åç»­æµç¨‹ï¼ˆç”Ÿæˆæç¤ºè¯ â†’ å¤åˆ¶åˆ° AI â†’ å¯¼å…¥ç»“æœï¼‰
```

---

## å…­ã€å®ç°æ­¥éª¤

### Step 1: å®‰è£…ä¾èµ–

```bash
npm install lunar-javascript
```

### Step 2: åˆ›å»ºæ’ç›˜æœåŠ¡

åˆ›å»º `services/paipanService.ts`ï¼Œå®ç°æ ¸å¿ƒæ’ç›˜é€»è¾‘ã€‚

### Step 3: åˆ›å»ºæ’ç›˜ç»„ä»¶

åˆ›å»º `components/AutoPaipanForm.tsx`ï¼Œå®ç° UI è¡¨å•ã€‚

### Step 4: é›†æˆåˆ° ImportDataMode

ä¿®æ”¹ `components/ImportDataMode.tsx`ï¼š
- æ·»åŠ é€‰é¡¹å¡åˆ‡æ¢ï¼ˆè‡ªåŠ¨/æ‰‹åŠ¨ï¼‰
- é›†æˆ AutoPaipanForm ç»„ä»¶
- å®ç°æ’ç›˜ç»“æœè‡ªåŠ¨å¡«å……

### Step 5: æµ‹è¯•éªŒè¯

- æµ‹è¯•ä¸åŒå¹´ä»½ã€æ—¶è¾°çš„æ’ç›˜ç»“æœ
- éªŒè¯å¤§è¿æ–¹å‘è®¡ç®—
- éªŒè¯èµ·è¿å¹´é¾„è®¡ç®—

---

## ä¸ƒã€æ³¨æ„äº‹é¡¹

### 7.1 æ—¶è¾°å¤„ç†

- å­æ—¶éœ€è¦ç‰¹æ®Šå¤„ç†ï¼ˆè·¨æ—¥é—®é¢˜ï¼‰
  - æ—©å­æ—¶ï¼ˆ00:00-01:00ï¼‰ï¼šå±äºå½“æ—¥
  - æ™šå­æ—¶ï¼ˆ23:00-24:00ï¼‰ï¼šå±äºå½“æ—¥
- æä¾›"ä¸çŸ¥é“æ—¶è¾°"é€‰é¡¹ï¼Œé»˜è®¤æŒ‰åˆæ—¶ï¼ˆ12:00ï¼‰è®¡ç®—

### 7.2 èŠ‚æ°”è¾¹ç•Œ

- å…«å­—æœˆæŸ±ä»¥èŠ‚æ°”ä¸ºç•Œï¼Œä¸æ˜¯å†œå†åˆä¸€
- lunar-javascript å·²æ­£ç¡®å¤„ç†æ­¤é€»è¾‘

### 7.3 çœŸå¤ªé˜³æ—¶ï¼ˆå¯é€‰å¢å¼ºï¼‰

- ä¸åŒåœ°åŒºçš„çœŸå¤ªé˜³æ—¶æœ‰å·®å¼‚
- å¯æ·»åŠ å‡ºç”Ÿåœ°ç‚¹è¾“å…¥ï¼Œè¿›è¡Œæ—¶é—´æ ¡æ­£
- ç®€åŒ–ç‰ˆæœ¬å¯å¿½ç•¥æ­¤é—®é¢˜

### 7.4 é—°æœˆå¤„ç†

- å†œå†é—°æœˆçš„æ’ç›˜éœ€è¦ç‰¹æ®Šå¤„ç†
- lunar-javascript å·²æ­£ç¡®å¤„ç†æ­¤é€»è¾‘

---

## å…«ã€é¢„è®¡å·¥ä½œé‡

| ä»»åŠ¡ | é¢„è®¡æ—¶é—´ |
|------|----------|
| å®‰è£…é…ç½® lunar-javascript | 10 åˆ†é’Ÿ |
| åˆ›å»º paipanService.ts | 30 åˆ†é’Ÿ |
| åˆ›å»º AutoPaipanForm.tsx | 1 å°æ—¶ |
| é›†æˆåˆ° ImportDataMode.tsx | 30 åˆ†é’Ÿ |
| æµ‹è¯•ä¸è°ƒè¯• | 30 åˆ†é’Ÿ |
| **æ€»è®¡** | **çº¦ 2.5-3 å°æ—¶** |

---

## ä¹ã€æ‰©å±•åŠŸèƒ½ï¼ˆå¯é€‰ï¼‰

### 9.1 å†œå†è¾“å…¥æ”¯æŒ

- æ·»åŠ é˜³å†/å†œå†åˆ‡æ¢
- æ”¯æŒç”¨æˆ·ç›´æ¥è¾“å…¥å†œå†æ—¥æœŸ

### 9.2 å‡ºç”Ÿåœ°ç‚¹

- æ·»åŠ çœå¸‚é€‰æ‹©
- æ ¹æ®ç»åº¦è®¡ç®—çœŸå¤ªé˜³æ—¶æ ¡æ­£

### 9.3 æ’ç›˜ç»“æœå¢å¼º

- æ˜¾ç¤ºäº”è¡Œåˆ†å¸ƒ
- æ˜¾ç¤ºåç¥å…³ç³»
- æ˜¾ç¤ºå‘½ä¸­ç¥ç…

### 9.4 å†å²è®°å½•

- ä¿å­˜æœ€è¿‘æ’ç›˜è®°å½•
- æ–¹ä¾¿å¿«é€Ÿé‡æ–°åˆ†æ

---

## åã€å‚è€ƒèµ„æ–™

### lunar-javascript æ–‡æ¡£

- GitHub: https://github.com/6tail/lunar-javascript
- ç¤ºä¾‹: https://6tail.cn/calendar/api.html

### æ ¸å¿ƒ API

```javascript
import { Solar, Lunar } from 'lunar-javascript';

// é˜³å†è½¬å†œå†
const solar = Solar.fromYmdHms(1990, 5, 15, 10, 30, 0);
const lunar = solar.getLunar();

// è·å–å…«å­—
const bazi = lunar.getEightChar();
bazi.getYear();   // å¹´æŸ±
bazi.getMonth();  // æœˆæŸ±
bazi.getDay();    // æ—¥æŸ±
bazi.getTime();   // æ—¶æŸ±

// è·å–å¤§è¿
const yun = bazi.getYun(1);  // 1=ç”·, 0=å¥³
yun.getStartYear();          // èµ·è¿å¹´é¾„
yun.getDaYun();              // å¤§è¿æ•°ç»„
```

---

> ğŸ’¡ **ä¸‹ä¸€æ­¥**ï¼šå¦‚æœç¡®è®¤æ­¤æ–¹æ¡ˆï¼Œå¯ä»¥å¼€å§‹å®æ–½ã€‚å»ºè®®å…ˆå®‰è£… lunar-javascript å¹¶æµ‹è¯•åŸºæœ¬åŠŸèƒ½ï¼Œç¡®ä¿è®¡ç®—ç»“æœå‡†ç¡®ã€‚

